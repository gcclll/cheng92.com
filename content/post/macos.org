#+TITLE: My MacOS
#+DATE: <2021-07-01 20:12:38>
#+TAGS[]: macos
#+CATEGORIES[]: macos
#+LANGUAGE: zh-cn
#+STARTUP: indent

#+begin_example
ğŸ˜€ğŸ˜€ğŸ˜€ğŸ˜€ğŸ˜€ğŸ˜€ğŸ˜€ğŸ˜€ğŸ˜€ğŸ˜€ğŸ˜€ğŸ˜€ğŸ˜€ğŸ˜€ğŸ˜€ğŸ˜€
MacOS ç³»ç»Ÿç›¸å…³çš„ä¸œè¥¿
ğŸ˜€ğŸ˜€ğŸ˜€ğŸ˜€ğŸ˜€ğŸ˜€ğŸ˜€ğŸ˜€ğŸ˜€ğŸ˜€ğŸ˜€ğŸ˜€ğŸ˜€ğŸ˜€ğŸ˜€ğŸ˜€
#+end_example

#+begin_export html
<script src="/js/utils.js"></script>
<script src="/js/vue/vue-next.js"></script>
<script>
insertCssLink("https://unpkg.com/element-plus/lib/theme-chalk/index.css");
insertCssLink("/js/vue/css/awesome.css");
</script>
<script src="https://unpkg.com/element-plus/lib/index.full.js"></script>
<script src="/js/vue/awesome/common.js"></script>
#+end_export

* CLI
** [[https://github.com/jarun/bcal#installation][bcal]], å­—èŠ‚è®¡ç®—ï¼Œè½¬æ¢

bcal è¿›å…¥æˆ–ç›´æ¥ä½¿ç”¨ ~$ bcal <expr> ...~ :

#+begin_src sh
â•­â”€simon at gcl in ~/.doom.d on nativeâœ˜âœ˜âœ˜ 21-07-22 - 15:24:39
â•°â”€â  â µ bcal                                                                     ~/.doom.d
q/double Enter -> quit, ? -> help
bcal> "(5kb+10mb)"
                                10005000 B

            IEC standard (base 2)

                        9.7705078125e+03 KiB
                        9.5415115356e+00 MiB
                        9.3178823590e-03 GiB
                        9.0994944912e-06 TiB

            SI standard (base 10)

                                   10005 kB
                        1.0005000000e+01 MB
                        1.0005000000e-02 GB
                        1.0005000000e-05 TB

ADDRESS
 (d) 10005000
 (h) 0x98aa08
bcal>
#+end_src

ä½¿ç”¨æ–¹å¼ï¼Œé‡‡ç”¨å„ç§è¡¨è¾¾å¼æ–¹å¼ï¼š

1. æ”¯æŒæ•°å­¦è®¡ç®—

    #+begin_src sh
    $ bcal "(5kb+2mb)/3"
    $ bcal "5 tb / 12"
    $ bcal "2.5mb*3"
    â•°â”€â  â µ bcal "2.5mb*3"                                                           ~/.doom.d
    RESULT
                                    7500000 B

                IEC standard (base 2)

                            7.3242187500e+03 KiB
                            7.1525573730e+00 MiB
                            6.9849193096e-03 GiB
                            6.8212102633e-06 TiB

                SI standard (base 10)

                                        7500 kB
                            7.5000000000e+00 MB
                            7.5000000000e-03 GB
                            7.5000000000e-06 TB

    ADDRESS
    (d) 7500000
    (h) 0x7270e0

    $ bcal "(2giB * 2) / (2kib >> 2)"
    â•°â”€â  â µ bcal "(2giB * 2) / (2kib >> 2)"                                          ~/.doom.d
    8388608
    #+end_src

2. è½¬æˆå…¶å®ƒæ ¼å¼ï¼Œå•ä½å¤§å°å†™æ•æ„Ÿ

   #+begin_src sh
    $ bcal 20140115 b
    $ bcal 0x1335053 B
    $ bcal 0xaabbcc kb
    $ bcal 0xdef Gib

    â•­â”€simon at gcl in ~/.doom.d on nativeâœ” 21-07-22 - 15:39:04
    â•°â”€â  â µ bcal 20140115 b                                                          ~/.doom.d
    UNIT CONVERSION
                                    20140115 B

                IEC standard (base 2)

                            1.9668081055e+04 KiB
                            1.9207110405e+01 MiB
                            1.8756943755e-02 GiB
                            1.8317327886e-05 TiB

                SI standard (base 10)

                            2.0140115000e+04 kB
                            2.0140115000e+01 MB
                            2.0140115000e-02 GB
                            2.0140115000e-05 TB

    ADDRESS
    (d) 20140115
    (h) 0x1335053

    LBA:OFFSET (sector size: 0x200)
    (d) 39336:83
    (h) 0x99a8:0x53
   #+end_src

3. æŒ‡å®šåŒºå—å¤§å°

   #+begin_src sh
    $ bcal 0xaabbcc kb -s 4096
   #+end_src

4. LBA è½¬æˆ CHS:

    #+begin_src sh
    $ bcal -f l500
    $ bcal -f l0x600-18-0x7e
    $ bcal -f l0x300-0x12-0x7e

    # result:
    â•­â”€simon at gcl in ~/.doom.d on nativeâœ” 21-07-22 - 15:32:44
    â•°â”€â  â µ bcal -f l500                                                             ~/.doom.d
    LBA2CHS
    LBA:500  MAX_HEAD:16  MAX_SECTOR:63
    CHS: (d) 0 7 60, (h) 0x0 0x7 0x3c
    #+end_src

5. CHS è½¬æˆ LBA

   #+begin_src sh
    $ bcal -f l500
    $ bcal -f l0x600-18-0x7e
    $ bcal -f l0x300-0x12-0x7e

    # result:
    â•­â”€simon at gcl in ~/.doom.d on nativeâœ” 21-07-22 - 15:40:28
    â•°â”€â  â µ bcal -f l0x300-0x12-0x7e                                                 ~/.doom.d
    LBA2CHS
    LBA:768  MAX_HEAD:18  MAX_SECTOR:126
    CHS: (d) 0 6 13, (h) 0x0 0x6 0xd
   #+end_src

6. æ˜¾ç¤ºä¸€ä¸ªæ•°æ®çš„2è¿›åˆ¶ï¼Œ10 è¿›åˆ¶å’Œ 16 è¿›åˆ¶è¡¨ç¤ºå½¢å¼

   *b* (2è¿›åˆ¶), *d* (åè¿›åˆ¶), *h* (16è¿›åˆ¶)ã€‚

   #+begin_src sh
    $ bcal -c 20140115
    â•­â”€simon at gcl in ~/.doom.d on nativeâœ” 21-07-22 - 15:44:32
    â•°â”€â  â µ bcal -c 20140115                                                         ~/.doom.d
    (b) 0b1001100110101000001010011
    (d) 20140115
    (h) 0x1335053

    $ bcal -c 0b1001100110101000001010011
    â•­â”€simon at gcl in ~/.doom.d on nativeâœ” 21-07-22 - 15:44:14
    â•°â”€â  â µ bcal -c 0b1001100110101000001010011                                      ~/.doom.d
    (b) 0b1001100110101000001010011
    (d) 20140115
    (h) 0x1335053

    $ bcal -c 0x1335053

    â•­â”€simon at gcl in ~/.doom.d on nativeâœ” 21-07-22 - 15:42:10
    â•°â”€â  â µ bcal -c 0x1335053                                                        ~/.doom.d
    (b) 0b1001100110101000001010011
    (d) 20140115
    (h) 0x1335053
   #+end_src

   äº¤äº’æ¨¡å¼ï¼š
   #+begin_src sh
    q/double Enter -> quit, ? -> help
    bcal> c 20140115 # ç›´æ¥ä½¿ç”¨å¯¹åº”çš„é€‰é¡¹
   #+end_src

7. æ‰§è¡Œ ~bc~, åœ¨äº¤äº’æ¨¡å¼ä¸‹è¾“å…¥ ~b~

   #+begin_src sh
    $ bcal -b '3.5 * 2.1 + 5.7'
    bcal> b
    bc vars: scale = 10, ibase = 10, last = r
    bc> 3.5 * 2.1 + 5.7
   #+end_src

8. ç®¡é“è¾“å…¥ï¼Œç»“æœç»™ *bcal* å¤„ç†

   #+begin_src sh
   $ printf '15 kib + 15 gib \n r / 5' | bcal -m
   $ printf '15 + 15 + 2' | bcal -bm
   #+end_src

9. ä»æ–‡ä»¶è·å–è¾“å…¥ç»™ *bcal*

   #+begin_src sh
    $ cat expr
    15 gib + 15 kib
    r / 5
    $ bcal -m < expr
   #+end_src

* Nix

install:

[[https://nixos.org/][NixOS - NixOS Linux]]

[[https://zhuanlan.zhihu.com/p/88886592][Nix on macOS, Made Easy - çŸ¥ä¹]]

[[https://wickedchicken.github.io/post/macos-nix-setup/][MacOS Nix Setup (an alternative to Homebrew)]]

~$ curl -L https://nixos.org/nix/install | sh~

æ–°ç³»ç»Ÿä¸èƒ½å®‰è£…é—®é¢˜ï¼Œæ— æƒé™åˆ›å»º ~/nix~

~$ sh <(curl -L https://nixos.org/nix/install) --darwin-use-unencrypted-nix-store-volume~

#+begin_example
Creating volume and mountpoint /nix.

     ------------------------------------------------------------------
    | This installer will create a volume for the nix store and        |
    | configure it to mount at /nix.  Follow these steps to uninstall. |
     ------------------------------------------------------------------

  1. Remove the entry from fstab using 'sudo vifs'
  2. Destroy the data volume using 'diskutil apfs deleteVolume'
  3. Remove the 'nix' line from /etc/synthetic.conf or the file

  ...

Installation finished!  To ensure that the necessary environment
variables are set, either log in again, or type

  . /Users/simon/.nix-profile/etc/profile.d/nix.sh

in your shell.
#+end_example

å®Œæˆä¹‹åï¼š

#+begin_example
# simon @ gcl in ~ [20:18:32]
$ nix
Usage: nix <COMMAND> <FLAGS>... <ARGS>...

Common flags:
      --debug                  enable debug output
      --help                   show usage information
      --help-config            show configuration options
      --no-net                 disable substituters and consider all previously downloaded files up-to-date
      --option <NAME> <VALUE>  set a Nix configuration option (overriding nix.conf)
  -L, --print-build-logs       print full build logs on stderr
      --quiet                  decrease verbosity level
  -v, --verbose                increase verbosity level
      --version                show version information

In addition, most configuration settings can be overriden using '--<name> <value>'.
Boolean settings can be overriden using '--<name>' or '--no-<name>'. See 'nix
--help-config' for a list of configuration settings.

Available commands:
  add-to-store     add a path to the Nix store
  build            build a derivation or fetch a store path
  cat-nar          print the contents of a file inside a NAR file
  cat-store        print the contents of a store file on stdout
  copy             copy paths between Nix stores
  copy-sigs        copy path signatures from substituters (like binary caches)
  doctor           check your system for potential problems
  dump-path        dump a store path to stdout (in NAR format)
  edit             open the Nix expression of a Nix package in $EDITOR
  eval             evaluate a Nix expression
  hash-file        print cryptographic hash of a regular file
  hash-path        print cryptographic hash of the NAR serialisation of a path
  log              show the build log of the specified packages or paths, if available
  ls-nar           show information about the contents of a NAR file
  ls-store         show information about a store path
  optimise-store   replace identical files in the store by hard links
  path-info        query information about store paths
  ping-store       test whether a store can be opened
  repl             start an interactive environment for evaluating Nix expressions
  run              run a shell in which the specified packages are available
  search           query available packages
  show-config      show the Nix configuration
  show-derivation  show the contents of a store derivation
  sign-paths       sign the specified paths
  to-base16        convert a hash to base-16 representation
  to-base32        convert a hash to base-32 representation
  to-base64        convert a hash to base-64 representation
  to-sri           convert a hash to SRI representation
  upgrade-nix      upgrade Nix to the latest stable version
  verify           verify the integrity of store paths
  why-depends      show why a package has another package in its closure

Note: this program is EXPERIMENTAL and subject to change.
#+end_example

å®‰è£… nix-darwin:

#+begin_src bash
nix-build https://github.com/LnL7/nix-darwin/archive/master.tar.gz -A installer
./result/bin/darwin-installer
#+end_src

é…ç½®ï¼š ~/Users/simon/.nixpkgs/darwin-configuration.nix~

#+begin_example
{ config, pkgs, ... }:

{
  # List packages installed in system profile. To search by name, run: $ nix-env -qaP | grep wget
  environment.systemPackages =
    [ pkgs.vim
    ];

  # Use a custom configuration.nix location. $ darwin-rebuild switch -I
  # darwin-config=$HOME/.config/nixpkgs/darwin/configuration.nix environment.darwinConfig =
  # "$HOME/.config/nixpkgs/darwin/configuration.nix";

  # Auto upgrade nix package and the daemon service. services.nix-daemon.enable = true;
  # nix.package = pkgs.nix;

  # Create /etc/bashrc that loads the nix-darwin environment.
  programs.zsh.enable = true; # default shell on catalina
  # programs.fish.enable = true;

  # Used for backwards compatibility, please read the changelog before changing. $ darwin-rebuild
  # changelog
  system.stateVersion = 4;
}
#+end_example

é…ç½®æ–‡ä»¶æ¯æ¬¡ä¿®æ”¹ä¹‹åè¦æ‰§è¡Œ ~darwin-rebuild switch~ ç”Ÿæ•ˆã€‚

æ›´æ–°åŒ…: ~nix-channel --update~
* awesome tools

https://github.com/jaywcjlove/awesome-mac/blob/master/README-zh.md

example:
#+begin_src html
<div id="test"></div>
<script src="/path/to/test.js"></script>
#+end_src

** Share VPN

Parallel Desktop - Ubuntu share the VPN of host computer.

Ubuntu -> è®¾ç½® -> ç½‘ç»œ -> VPN: Network Proxy, ç½‘ç»œä»£ç†ï¼š

http/https, socks proxy:

IP: å®¿ä¸»æœºçš„ IPï¼Œæ¨èé…ç½®æˆé™æ€IPã€‚

PORT: ä»£ç†å·¥å…·çš„ç«¯å£å·ï¼Œæ¯”å¦‚ï¼š clashX çš„ *7890/7891*

å®Œäº†ä¹‹åè¿˜è¦åœ¨ä»£ç å·¥å…·é‚£å…è®¸ä¸‹å±€åŸŸç½‘è¿æ¥ï¼š

[[/img/tmp/clashx-allow-lan.png]]

** çª—å£ç®¡ç†

#+begin_export html
<div id="mac-window"></div>
<script src="/js/vue/awesome/mac-window.js"></script>
#+end_export
* ubuntu

** [[https://www.cnblogs.com/yxqxx/p/12319130.html][ä¿®æ”¹å®¶ç›®å½•å’Œä¸»æœºå]]

å‡è®¾å½“å‰åå­—ä¸º ~parallels~ (å®‰è£…è™šæ‹Ÿæœºçš„æ—¶å€™é»˜è®¤æ˜¯è¿™ä¸ª), å°†åŸºä¿®æ”¹ä¸ºï¼š ~simon~

1. ~$ su~ , åˆ‡æ¢ root
2. ~$ passwd <user>~, ä¿®æ”¹å¯†ç 
3. ~$ reboot~, é‡å¯
4. ~$ su~
5. ~$ vim /etc/passwd~, æ‰¾åˆ° ~parallels~ é‚£ä¸€è¡Œï¼Œ *åªä¿®æ”¹ç”¨æˆ·åä¸º simonï¼Œå…¶å®ƒä¸è¦åŠ¨*
6. ~$ vim /etc/shadow~, æ‰¾åˆ° ~parallels~ é‚£ä¸€è¡Œï¼ŒåŒæ ·åªä¿®æ”¹ç”¨æˆ·åä¸º simon
7. ~$ vim /etc/group~, æ‰¾åˆ°æ‰€æœ‰çš„ ~parallels~, ä½¿ç”¨ ~:%s/parallels/simon/g~ å…¨å±€æ›¿æ¢
8. ~$ reboot~, é‡å¯
9. ~$ vim /etc/hostname~ ä¿®æ”¹æˆæƒ³è¦çš„ä¸»æœºå
10. ~$ vim /etc/passwd~ æ‰¾åˆ° ~simon~ é‚£ä¸€è¡Œ(è¿™é‡Œç”¨æˆ·åå·²ç»ç»è¿‡ä¸Šé¢çš„ä¿®æ”¹æˆäº† ~simon~)ï¼Œ
    ä¿®æ”¹ç›®å½•å
11. ~$ cd /home~
12. ~$ mv parallels simon~, ä¿®æ”¹å®¶ç›®å½•åå­—
13. ~$ reboot~, OK.


å¯èƒ½çš„é—®é¢˜ï¼ˆæˆ‘æ²¡é‡åˆ°ï¼‰ï¼šä¿®æ”¹ä¸»ç›®å½•åæ—¶å€™ï¼Œåªä¿®æ”¹äº† ~/etc/password~ è€Œæ²¡æœ‰ç»™
~/home/parallels~ é‡å‘½åï¼Œå¯¼è‡´å¼€æœºåä¸€ç›´ç™»é™†è›¤é¢å¾ªç¯ã€‚

*è§£* ï¼š ~Ctrl+Alt+[F1~F6]~ ç™»é™†åç›´æ¥ä¿®æ”¹ ~/home/parallels~, é‡å¯ã€‚

~Ctrl+Alt+F7~ è¿›å…¥å›¾å½¢æ¨¡å¼ã€‚
